---
title: "wordcloud"
output: html_document
---
####
```{r cars}
library(jiebaR)
library(wordcloud)
library(magrittr)
```
####
```{r}
wk <- worker()
```

```{r}
text <- readLines("Mayunspeech1.txt", encoding = "UTF-8")
```

```{r}
stopwords <- c("我", "的", "在", "和", "都", "也", "不", "就", "上", "为", "我们", "这", "从","是", "会", "个","有","像","把","其实")
```

```{r}
stopwords.pattern <- paste0(stopwords, sep = "|", collapse = "") %>%
  substr(1, nchar(.) -1)
```

```{r}
text <- gsub(stopwords.pattern, " ", text)
```

```{r}
speech <- wk[text]
```

```{r}
speech <- as.data.frame(table(speech))
```

```{r}
freq <- speech[order(speech$Freq, decreasing = T),]
```

```{r}
wordcloud(freq$speech, freq$Freq,
          min.freq = 2, random.order = F,
          color = brewer.pal(8, "Dark2"))
```
