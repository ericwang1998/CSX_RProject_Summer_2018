countries <- transform(as.data.frame(table(wine_complete$country))) %>%
countries <- arrange(countries, desc(Freq))
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
countries <- order(countries$Freq, decreasing = TRUE)
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
countries <- order(countries, decreasing = TRUE)
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
countries <- order(countries$data, decreasing = TRUE)
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
countries <- order(countries$Freq, decreasing = TRUE)
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
countries <- arrange(des(countries$Freq))
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
countries <- arrange(desc(countries$Freq))
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
countries <- arrange(desc(countries))
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
tidy()
library(tidyverse)
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
tidy()
library(tidyr)
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
tidy()
library(broom)
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
tidy()
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
countries_df <- countries$data
countries_df <- countries$data
countries_df <- countries$data %>%
arrange(desc(countries))
View(countries_df)
countries <- transform(as.data.frame(table(wine_complete$country)))
View(countries_df)
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
arrange(desc(countries))
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
arrange(desc())
View(countries)
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
order(decreasing = TRUE))
countries <- transform(as.data.frame(table(wine_complete$country))) %>%
order(decreasing = TRUE)
countries
countries <- transform(as.data.frame(table(wine_complete$country)))
countries_df <- countries$data %>%
arrange(desc)
rm(countries_df)
countries_df <- countries$Freq %>%
arrange(desc)
countries_df <- countries$Freq %>%
arrange(desc())
order(countries$Freq, decreasing = TRUE)
countries <- countries[order(countries$Freq, decreasing = TRUE)]
countries[order(countries$Freq, decreasing = TRUE),]
countries <- countries[order(countries$Freq, decreasing = TRUE),]
countries %>%
top_n(5)%>%
ggplot(aes(x = Var1, y = Freq)) +
geom_bar(colour = "orange") +
ggtitle("Top 5 most reviewed countries") +
coord_flip()
ggplot(countries, aes(x = Var1, y = Freq)) +
geom_bar(colour = "orange") +
ggtitle("Top 5 most reviewed countries") +
coord_flip()
countries %>%
top_n(5)%>%
ggplot(countries, aes(x = Var1)) +
geom_bar(colour = "orange") +
ggtitle("Top 5 most reviewed countries") +
coord_flip()
countries %>%
top_n(5)%>%
ggplot(aes(x = Var1)) +
geom_bar(colour = "orange") +
ggtitle("Top 5 most reviewed countries") +
coord_flip()
countries %>%
top_n(5)%>%
ggplot(aes(x = Var1)) +
geom_bar(colour = "orange") +
ggtitle("Top 5 most reviewed countries") +
countries %>%
top_n(5)%>%
ggplot(aes(x = Var1, y = Freq)) +
geom_bar(colour = "orange") +
ggtitle("Top 5 most reviewed countries") +
countries %>%
top_n(5)%>%
ggplot(aes(x = Var1, y = Freq)) +
geom_bar(colour = "orange") +
ggtitle("Top 5 most reviewed countries")
countries %>%
ggplot(aes(x = Var1, y = Freq)) +
geom_bar(colour = "orange") +
ggtitle("Top 5 most reviewed countries")
countries %>%
ggplot(aes(x = Var1)) +
geom_bar(colour = "orange") +
ggtitle("Top 5 most reviewed countries")
countries %>%
ggplot(aes(x = Var1, y = Freq)) +
geom_histogram(colour = "orange") +
ggtitle("Top 5 most reviewed countries")
countries %>%
ggplot(aes(x = Var1)) +
geom_histogram(colour = "orange") +
ggtitle("Top 5 most reviewed countries")
countries %>%
ggplot(aes(x = Freq)) +
geom_histogram(colour = "orange") +
ggtitle("Top 5 most reviewed countries")
countries %>%
ggplot(aes(x = Var1)) +
geom_bar(colour = "orange") +
ggtitle("Top 5 most reviewed countries")
countries %>%
ggplot(aes(x = Var1, y = Freq)) +
geom_bar(colour = "orange") +
ggtitle("Top 5 most reviewed countries")
countries %>%
ggplot(aes(x = Var1, y = Freq)) +
geom_bin2d(colour = "orange") +
ggtitle("Top 5 most reviewed countries")
countries %>%
ggplot(aes(x = Var1, y = Freq)) +
geom_bin2d() +
ggtitle("Top 5 most reviewed countries")
countries %>%
head(.,5) %>%
ggplot(aes(x = Var1, y = Freq)) +
geom_bin2d() +
ggtitle("Top 5 most reviewed countries")
countries %>%
head(.,5) %>%
ggplot(aes(x = Var1, y = Freq)) +
geom_bar() +
ggtitle("Top 5 most reviewed countries")
countries %>%
head(.,5) %>%
ggplot(aes(x = Var1)) +
geom_bar() +
ggtitle("Top 5 most reviewed countries")
countries %>%
head(.,5) %>%
ggplot(aes(x = Var1, y = Freq)) +
geom_bin2d() +
ggtitle("Top 5 most reviewed countries")
countries %>%
head(.,5) %>%
ggplot(aes(x = Var1, y = Freq)) +
geom_area() +
ggtitle("Top 5 most reviewed countries")
countries %>%
head(.,5) %>%
ggplot(aes(x = Var1, y = Freq)) +
geom_col() +
ggtitle("Top 5 most reviewed countries")
countries %>%
head(.,5) %>%
ggplot(aes(x = Var1, y = Freq)) +
geom_col(color = "purple") +
ggtitle("Top 5 most reviewed countries")
countries %>%
head(.,5) %>%
ggplot(aes(x = Var1, y = Freq, fill = "purple")) +
geom_col(color = "purple") +
ggtitle("Top 5 most reviewed countries")
countries %>%
head(.,5) %>%
ggplot(aes(x = Var1, y = Freq, color = "purple")) +
geom_col(color = "purple") +
ggtitle("Top 5 most reviewed countries")
countries %>%
head(.,5) %>%
ggplot(aes(x = Var1, y = Freq)) +
geom_col() +
ggtitle("Top 5 most reviewed countries")
top_5_countries <- c("Chile", "France", "Italy", "Spain", "US")
## Top rated
top_5_mean_price <- wine_complete %>%
filter(country == top_5_countries) %>%
group_by(country) %>%
colsum(price)
## Top rated
top_5_mean_price <- wine_complete %>%
filter(country == top_5_countries) %>%
group_by(country) %>%
mean(price)
## Top rated
top_5_mean_price <- wine_complete %>%
filter(country == top_5_countries) %>%
group_by(country) %>%
sum(price)
## Top rated
top_5_mean_price <- wine_complete %>%
filter(country == top_5_countries) %>%
group_by(country) %>%
colsums(price)
## Top rated
top_5_mean_price <- wine_complete %>%
filter(country == top_5_countries) %>%
group_by(country) %>%
colSums(price)
## Top rated
top_5_mean_price <- wine_complete %>%
filter(country == top_5_countries) %>%
group_by(country) %>%
colSums()
## Top rated
top_5_mean_price <- wine_complete %>%
filter(country == top_5_countries) %>%
group_by(country) %>%
select(price)%>%
colSums()
## Top rated
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean)
View(Mean_prices)
Mean_scores <- aggregate(wine_complete$points, by= list(Country = wine_complete$country), FUN = mean)
View(Mean_scores)
View(countries)
View(Mean_prices)
wine_complete %>%
filter(country == top_5_countries) %>%
ggplot(aes(x = country, y = score ))
wine_complete %>%
filter(country == top_5_countries) %>%
ggplot(aes(x = country, y = points))
+ geom_bar()
wine_complete %>%
ggplot(aes(x = country, y = points))
+ geom_point()
+ ggtitle("Distribution of scores for top 5 countries")
+ facet_wrap(~country)
wine_complete %>%
ggplot(aes(x = country, y = points)) +
geom_col() +
facet_wrap(~country) +
ggtitle("Distribution of scores for top 5 countries")
wine_complete %>%
filter(country == top_5_countries)
wine_complete %>%
filter(country == top_5_countries) %>%
ggplot(aes(x = country, y = points)) +
geom_col() +
facet_wrap(~country) +
ggtitle("Distribution of scores for top 5 countries")
wine_complete %>%
filter(country == top_5_countries) %>%
ggplot(aes(x = points)) +
geom_histogram() +
facet_wrap(~country) +
ggtitle("Distribution of scores for top 5 countries")
wine_complete %>%
filter(country == top_5_countries) %>%
ggplot(aes(x = price)) +
geom_histogram() +
facet_wrap(~country) +
ggtitle("Distribution of scores for top 5 countries")
## Top rated
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean) %>%
filter(country == top_5_countries)
## Top rated
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean) %>%
filter(Country == top_5_countries)
## Top rated
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean) %>%
select(Country == top_5_countries)
View(countries)
View(Mean_prices)
## Top rated
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean) %>%
filter(Country == top_5_countries)
## Top rated
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean) %>%
filter(Country == as.factor(top_5_countries))
## Top rated
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean)
View(Mean_prices)
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean) %>%
filter(Country == top_5_countries)
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean) %>%
filter(Country == as.factor(top_5_countries))
ggplot(wine_complete, aes(x = price)) + geom_histogram(binwidth = 1) + ggtitle("Distribution of price") +
ggplot(Mean_prices, aes(y = x)) + geom_abline()
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean) %>%
gsub(Country != top_5_countries)
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean) %>%
gsub(Country != top_5_countries,.)
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean) %>%
subset(., Country != top_5_countries)
top_5_countries_2 <- str_glue(top_5_countries, .sep = "|")
top_5_countries_2 <- c("Chile" | "France" | "Italy" | "Spain" | "US")
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean) %>%
subset(., Country != "Chile" | "France" | "Italy" | "Spain" | "US")
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean) %>%
filter(Country == "Chile"|"France"|"Italy"|"Spain"|"US")
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean) %>%
filter(Country == as.factor("Chile"|"France"|"Italy"|"Spain"|"US"))
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean) %>%
filter(Country == "Chile", "France", "Italy", "Spain", "US")
Mean_prices <- aggregate(wine_complete$price, by= list(Country = wine_complete$country), FUN = mean)
Mean_prices$Country <- as.character(Mean_prices$Country)
Mean_prices_T5 <- filter(Mean_prices, Country == top_5_countries)
View(Mean_prices_T5)
Mean_prices_T5 <- filter(Mean_prices, Country == "Chile", "France", "Italy", "Spain", "US")
Mean_prices_T5 <- filter(Mean_prices, Country == "Chile"| "France"| "Italy" | "Spain"| "US")
Mean_prices_T5 <- filter(Mean_prices, Country == top_5_countries)
ggplot(wine_complete, aes(x = price)) +
geom_histogram(binwidth = 1) +
ggtitle("Distribution of price") +
geom_hline(yintercept = Mean_prices$x, show.legend = Mean_prices$Country)
ggplot(wine_complete, aes(x = points)) +
geom_histogram(binwidth = 1) +
ggtitle("Distribution of points") +
geom_hline(yintercept = Mean_scores$x, show.legend = Mean_scores$Country)
ggplot(wine_complete, aes(x = points)) +
geom_histogram(binwidth = 1) +
ggtitle("Distribution of points") +
geom_vline(xintercept = Mean_scores$x, show.legend = Mean_scores$Country)
Mean_scores <- aggregate(wine_complete$points, by= list(Country = wine_complete$country), FUN = mean) %>%
sapply(gsub, country != top_5_countries)
Mean_scores <- aggregate(wine_complete$points, by= list(Country = wine_complete$country), FUN = mean) %>%
sapply(.,gsub, country != top_5_countries)
Mean_scores <- aggregate(wine_complete$points, by= list(Country = wine_complete$country), FUN = mean) %>%
Mean_scores <- Mean_scores[filter(Mean_scores$Country == top_5_countries),]
View(Mean_scores)
Mean_scores <- aggregate(wine_complete$points, by= list(Country = wine_complete$country), FUN = mean) %>%
Mean_scores <- Mean_scores[10, 16, 23, 41, 46]
Mean_scores <- aggregate(wine_complete$points, by= list(Country = wine_complete$country), FUN = mean) %>%
Mean_scores <- Mean_scores[c(10, 16, 23, 41, 46)]
Mean_scores <- aggregate(wine_complete$points, by= list(Country = wine_complete$country), FUN = mean) %>%
Mean_scores <- Mean_scores[c(10, 16, 23, 41, 46),]
library(magrittr)
Mean_scores_T5 <- Mean_scores[c(10, 16, 23, 41, 46),]
ggplot(wine_complete, aes(x = points)) +
geom_histogram(binwidth = 1) +
ggtitle("Distribution of points") +
geom_vline(xintercept = Mean_scores_T5$x, show.legend = Mean_scores$Country)
ggplot(wine_complete, aes(x = points)) +
geom_histogram(binwidth = 1) +
ggtitle("Distribution of points") +
geom_vline(mapping = aes(xintercept = Mean_scores_T5$x, linetype = Mean_scores_T5$Country), size = 1, colour = "#80cdc1", show_guide = T)
ggplot(wine_complete, aes(x = points)) +
geom_histogram(binwidth = 1, colour = "#bdbdbd") +
geom_density(size = 1, colour = "#cccccc") +
ggtitle("Distribution of points") +
geom_vline(mapping = aes(xintercept = Mean_scores_T5$x, colour = stat),
linetype = 1, size = 1, show_guide = T)
ggplot(wine_complete, aes(x = points)) +
geom_histogram(binwidth = 1, colour = "#bdbdbd") +
geom_density(size = 1, colour = "#cccccc") +
ggtitle("Distribution of points") +
geom_vline(mapping = aes(xintercept = Mean_scores_T5$x, colour = stat),
show.legend = Mean_scores_T5$Country)
ggplot(wine_complete, aes(x = points)) +
geom_histogram(binwidth = 1, colour = "#bdbdbd") +
geom_density(size = 1, colour = "#cccccc") +
ggtitle("Distribution of points") +
geom_vline(mapping = aes(xintercept = Mean_scores_T5$x, colour = stat),
show.legend = T)
ggplot(wine_complete, aes(x = points)) +
geom_histogram(binwidth = 1, colour = "#bdbdbd") +
geom_density(size = 1, colour = "#cccccc") +
ggtitle("Distribution of points") +
geom_vline(mapping = aes(xintercept = Mean_scores_T5$x, colour = "#cccccc"),
show.legend = T)
ggplot(wine_complete, aes(x = points)) +
geom_histogram(binwidth = 1, colour = "#bdbdbd") +
geom_density(size = 1, colour = "#cccccc") +
ggtitle("Distribution of points") +
geom_vline(mapping = aes(xintercept = Mean_scores_T5$x),
show.legend = T)
ggplot(wine_complete, aes(x = points)) +
geom_histogram(binwidth = 1, colour = "#bdbdbd") +
geom_density(size = 1, colour = "#cccccc") +
ggtitle("Distribution of points") +
geom_vline(mapping = aes(xintercept = Mean_scores_T5$x, linetype=Mean_scores_T5$Country),
size=1, colour='#80cdc1', show.legend = T)
ggplot(wine_complete, aes(x = points)) +
geom_histogram(binwidth = 1, colour = "#bdbdbd") +
geom_density(size = 1, colour = "#cccccc") +
ggtitle("Distribution of points") +
geom_vline(,mapping = aes(xintercept = Mean_scores_T5$x, linetype=Mean_scores_T5$Country),
size=1, colour='#80cdc1', show.legend = T)
ggplot(Mean_scores, aes(x = country, y = x)) + geom_bar()
ggplot(Mean_scores, aes(x = Country, y = x)) + geom_bar()
ggplot(Mean_scores, aes(x = Country, y = x)) + geom_col()
ggplot(Mean_scores, aes(x = Country, y = x)) +
geom_col() +
coord_flip()
ggplot(Mean_scores, aes(x = Country, y = x)) +
geom_col() +
coord_flip() +
ggtitle("Mean scores amongst the countries")
ggplot(Mean_scores, aes(x = Country, y = x, col = cols)) +
geom_col() +
coord_flip() +
ggtitle("Mean scores amongst the countries")
ggplot(Mean_scores, aes(x = Country, y = x, fill = top_5_countries)) +
geom_col() +
coord_flip() +
ggtitle("Mean scores amongst the countries")
ggplot(Mean_scores, aes(x = Country, y = x, fill = "US")) +
geom_col() +
coord_flip() +
ggtitle("Mean scores amongst the countries")
ggplot(Mean_scores, aes(x = Country, y = x)) +
geom_col() +
coord_flip() +
ggtitle("Mean scores amongst the countries")
ggplot(Median_scores, aes(x = Country, y = x)) +
geom_col() +
coord_flip() +
ggtitle("Median scores amongst the countries")
Median_scores <- aggregate(wine_complete$points, by= list(Country = wine_complete$country), FUN = median)
ggplot(Median_scores, aes(x = Country, y = x)) +
geom_col() +
coord_flip() +
ggtitle("Median scores amongst the countries")
View(Mean_scores_T5)
View(Mean_scores_T5)
View(Median_scores)
View(Median_scores)
# ANOVA for countries and score
color = c()
i = 0
while (i < 47) {
addNA(color)
i  + 1
}
while (i < 47) {
addNA(color)
i + 1
}
addNA(color)
while (i < 47) {
addNA(color)
i = i + 1
}
color <- addNA(color)
rm(color)
rm(i)
# ANOVA for countries and score
color = c()
i = 0
while (i < 47) {
color <-addNA(color)
i = i + 1
}
color
rm(color)
rm(i)
color = color + c(NA)
while (i < 47) {
color = color + c(NA)
i = i + 1
}
# ANOVA for countries and score
color = c()
i = 0
while (i < 47) {
color = color + c(NA)
i = i + 1
}
color
ggplot(Mean_scores, aes(x = Country, y = x, fill = "bcbcbc")) +
geom_col() +
coord_flip() +
ggtitle("Mean scores amongst the countries") +
ggplot(Median_scores, aes(x = Country, y = x)) +
geom_col() +
coord_flip() +
ggtitle("Median scores amongst the countries")
ggplot(Mean_scores, aes(x = Country, y = x, fill = "#bcbcbc")) +
geom_col() +
coord_flip() +
ggtitle("Mean scores amongst the countries") +
ggplot(Median_scores, aes(x = Country, y = x, fill = "#cccccc")) +
geom_col() +
coord_flip() +
ggtitle("Median scores amongst the countries")
ggplot(Mean_scores, aes(x = Country, y = x, fill = "#bcbcbc")) +
geom_col() +
coord_flip() +
ggtitle("Mean scores amongst the countries")
ggplot(Median_scores, aes(x = Country, y = x, fill = "#cccccc")) +
geom_col() +
coord_flip() +
ggtitle("Median scores amongst the countries")
View(Median_scores)
View(Median_scores)
unique(wine_complete$variety)
wine_complete %>%
filter(country == top_5_countries) %>%
ggplot(aes(x = price)) +
geom_histogram() +
facet_wrap(~country) +
ggtitle("Distribution of scores for top 5 countries")
wine_complete %>%
filter(country == top_5_countries) %>%
ggplot(aes(x = points)) +
geom_histogram() +
facet_wrap(~country) +
ggtitle("Distribution of scores for top 5 countries")
countries %>%
head(.,5) %>%
ggplot(aes(x = Var1, y = Freq)) +
geom_col() +
ggtitle("Top 5 most reviewed countries")
